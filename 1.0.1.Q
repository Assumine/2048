[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=3e193a52-9bfd-410f-ad44-565ae7bb89b9
Description=文档
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form2
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
DimEnv hwnd
Event Form2.LoadOver
Call 检查更新
hwnd = form2.hwnd
hwnd = Plugin.Window.GetParentWindow(hwnd)
hwnd = Plugin.Window.GetParentWindow(hwnd)
hwnd = Plugin.Window.GetParentWindow(hwnd)
End Event
Plugin.Window.Hide hwnd
form1.Show

Event Form1.UnLoad
plugin.Window.Close hwnd
End Event

Dim r(3, 3)
//随机值 
空=""
for m=0 to 3
    for n=0 to 3
        if r(m,n)="" then
            空=空 & m & n & " "
        End if
    next
Next
text = split(空, " ")
Randomize
a=text(int(rnd*(UBound(text)-1)))
Randomize
If int(rnd * 10) > 8 Then 
    r(left(a, 1), right(a, 1)) = 4
Else
    r(left(a,1),right(a,1))=2
End If
TracePrint a
TracePrint r(left(a, 1), right(a, 1))
For m = 0 To 3
    For n = 0 To 3
        Form1.Grid1.SetItemText n+1, m, r(m, n)
    Next
Next
Do
    Do
        Click = WaitClick
        If Click = 32782 Then 
            for m=0 to 3
                For n = 0 To 3
                    if r(m,n)=r(m,n+1) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m,n+1)=""
                    End If
                next
            Next 
            for m=0 to 3
                for n=0 to 3
                    If r(m, n) = "" Then 
                        If r(m, n + 1) = "" Then 
                            If r(m, n + 2) = "" Then 
                                r(m, n) = r(m, n + 3)
                                r(m,n+3)=""
                            Else 
                                r(m, n) = r(m, n + 2)
                                r(m,n+2)=""
                            End If
                        Else 
                            r(m, n) = r(m, n + 1)
                            r(m,n+1)=""
                        End If
                    Else 
                    End if
                next
            Next
            Exit Do
        End If
        ////
        If Click = 32781 Then 
            for m=0 to 3
                for n=3 to 0 step -1
                    if r(m,n)=r(m,n-1) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m,n-1)=""
                    End if
                next
            Next 
            for m=0 to 3
                for n=3 to 0 step -1
                    If r(m, n) = "" Then 
                        If r(m, n - 1) = "" Then 
                            If r(m, n - 2) = "" Then 
                                r(m, n) = r(m, n - 3)
                                r(m,n-3)=""
                            Else 
                                r(m, n) = r(m, n - 2)
                                r(m,n-2)=""
                            End If
                        Else 
                            r(m, n) = r(m, n - 1)
                            r(m,n-1)=""
                        End If
                    Else 
                    End if
                next
            Next
            Exit Do
        End If
        If Click = 32770 Then 
            for m=0 to 3
                For n = 0 To 3
                    if r(m,n)=r(m+1,n) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m+1,n)=""
                    End if
                next
            Next
            for n=0 to 3
                for m=0 to 3
                    If r(m, n) = "" Then 
                        If r(m+1, n) = "" Then 
                            If r(m+2, n) = "" Then 
                                r(m, n) = r(m+3, n)
                                r(m+3,n)=""
                            Else 
                                r(m, n) = r(m + 2, n)
                                r(m+2,n)=""
                            End If
                        Else 
                            r(m, n) = r(m + 1, n)
                            r(m+1,n)=""
                        End If
                    Else 
                    End if
                next
            Next
            Exit Do
        End If
        If Click = 32774 Then 
            for n=0 to 3
                for m=3 to 0 step -1
                    if r(m,n)=r(m-1,n) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m-1,n)=""
                    End If
                next
            next
            for n=0 to 3
                for m=3 to 0 step -1
                    If r(m, n) = "" Then 
                        If r(m-1, n) = "" Then 
                            If r(m-2, n) = "" Then 
                                r(m, n) = r(m-3, n)
                                r(m-3,n)=""
                            Else 
                                r(m, n) = r(m - 2, n)
                                r(m-2,n)=""
                            End If
                        Else 
                            r(m, n) = r(m - 1, n)
                            r(m-1,n)=""
                        End If
                    Else 
                    End if
                    if r(m,n)=r(m-1,n) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m-1,n)=""
                    End if
                next
            Next
            Exit Do
        End If
    Loop
    空=""
    for m=0 to 3
        for n=0 to 3
            if r(m,n)="" then
                空=空 & m & n & " "
            End if
        next
    Next
    text = split(空, " ")
    If UBound(text) > 0 Then 
        Randomize
        a=text(int(rnd*(UBound(text)-1)))
        Randomize
        If int(rnd * 10) > 8 Then 
            r(left(a, 1), right(a, 1)) = 4
        Else
            r(left(a,1),right(a,1))=2
        End If
        TracePrint a & " " & r(left(a, 1), right(a, 1))
    Else
    End If
    For m = 0 To 3
        For n = 0 To 3
            Form1.Grid1.SetItemText n+1, m, r(m, n)
        Next
    Next
Loop



Function 检查更新
    Set xPost = createObject("MSXML2.XMLHTTP")
    xPost.Open "GET", "https://github.com/Assumine/2048/wiki", False
    xPost.Send 
    Delay 10
    If xPost.readyState = 4 Then 
        TracePrint xPost.responsetext
        text11 = split(xPost.responsetext, "saa")
        For n=2 to UBound(text11)/2
            公告 = 公告 & text11(2 * n + 1) & chr(10)

        Next
                    Form2.Label1.Caption=公告
Form2.Label2.Caption = "当前版本: " & text11(1)
Else 
Form2.Label2.Caption ="网络错误"
    End If


    xPost.abort
    Set xPost = Nothing
End Function

