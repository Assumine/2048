[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=3e193a52-9bfd-410f-ad44-565ae7bb89b9
Description=文档
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form2
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
DimEnv hwnd
Event Form2.LoadOver
Call 检查更新
hwnd = form2.hwnd
hwnd = Plugin.Window.GetParentWindow(hwnd)
hwnd = Plugin.Window.GetParentWindow(hwnd)
hwnd = Plugin.Window.GetParentWindow(hwnd)
End Event
Plugin.Window.Hide hwnd
form1.Show

Event Form1.UnLoad
plugin.Window.Close hwnd
End Event

Dim r(3, 3)
//随机值 
空=""
for m=0 to 3
    for n=0 to 3
        if r(m,n)="" then
            空=空 & m & n & " "
        End if
    next
Next
text = split(空, " ")
Randomize
a=text(int(rnd*(UBound(text)-1)))
Randomize
If int(rnd * 10) > 8 Then 
    r(left(a, 1), right(a, 1)) = 4
Else
    r(left(a,1),right(a,1))=2
End If
TracePrint a
TracePrint r(left(a, 1), right(a, 1))
For m = 0 To 3
    For n = 0 To 3
        Form1.Grid1.SetItemText n+1, m, r(m, n)
    Next
Next
Do
    Do
        Click = WaitClick
        If Click = 32782 Then 
            for m=0 to 3
                For n = 0 To 3
                    if r(m,n)=r(m,n+1) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m,n+1)=""
                    End If
                next
            Next 
            for m=0 to 3
                for n=0 to 3
                    If r(m, n) = "" Then 
                        If r(m, n + 1) = "" Then 
                            If r(m, n + 2) = "" Then 
                                r(m, n) = r(m, n + 3)
                                r(m,n+3)=""
                            Else 
                                r(m, n) = r(m, n + 2)
                                r(m,n+2)=""
                            End If
                        Else 
                            r(m, n) = r(m, n + 1)
                            r(m,n+1)=""
                        End If
                    Else 
                    End if
                next
            Next
            Exit Do
        End If
        ////
        If Click = 32781 Then 
            for m=0 to 3
                for n=3 to 0 step -1
                    if r(m,n)=r(m,n-1) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m,n-1)=""
                    End if
                next
            Next 
            for m=0 to 3
                for n=3 to 0 step -1
                    If r(m, n) = "" Then 
                        If r(m, n - 1) = "" Then 
                            If r(m, n - 2) = "" Then 
                                r(m, n) = r(m, n - 3)
                                r(m,n-3)=""
                            Else 
                                r(m, n) = r(m, n - 2)
                                r(m,n-2)=""
                            End If
                        Else 
                            r(m, n) = r(m, n - 1)
                            r(m,n-1)=""
                        End If
                    Else 
                    End if
                next
            Next
            Exit Do
        End If
        If Click = 32770 Then 
            for m=0 to 3
                For n = 0 To 3
                    if r(m,n)=r(m+1,n) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m+1,n)=""
                    End if
                next
            Next
            for n=0 to 3
                for m=0 to 3
                    If r(m, n) = "" Then 
                        If r(m+1, n) = "" Then 
                            If r(m+2, n) = "" Then 
                                r(m, n) = r(m+3, n)
                                r(m+3,n)=""
                            Else 
                                r(m, n) = r(m + 2, n)
                                r(m+2,n)=""
                            End If
                        Else 
                            r(m, n) = r(m + 1, n)
                            r(m+1,n)=""
                        End If
                    Else 
                    End if
                next
            Next
            Exit Do
        End If
        If Click = 32774 Then 
            for n=0 to 3
                for m=3 to 0 step -1
                    if r(m,n)=r(m-1,n) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m-1,n)=""
                    End If
                next
            next
            for n=0 to 3
                for m=3 to 0 step -1
                    If r(m, n) = "" Then 
                        If r(m-1, n) = "" Then 
                            If r(m-2, n) = "" Then 
                                r(m, n) = r(m-3, n)
                                r(m-3,n)=""
                            Else 
                                r(m, n) = r(m - 2, n)
                                r(m-2,n)=""
                            End If
                        Else 
                            r(m, n) = r(m - 1, n)
                            r(m-1,n)=""
                        End If
                    Else 
                    End if
                    if r(m,n)=r(m-1,n) and r(m,n)>0 then
                        r(m,n)=r(m,n)*2
                        r(m-1,n)=""
                    End if
                next
            Next
            Exit Do
        End If
    Loop
    空=""
    for m=0 to 3
        for n=0 to 3
            if r(m,n)="" then
                空=空 & m & n & " "
            End if
        next
    Next
    text = split(空, " ")
    If UBound(text) > 0 Then 
        Randomize
        a=text(int(rnd*(UBound(text)-1)))
        Randomize
        If int(rnd * 10) > 8 Then 
            r(left(a, 1), right(a, 1)) = 4
        Else
            r(left(a,1),right(a,1))=2
        End If
        TracePrint a & " " & r(left(a, 1), right(a, 1))
    Else
    End If
    For m = 0 To 3
        For n = 0 To 3
            Form1.Grid1.SetItemText n+1, m, r(m, n)
        Next
    Next
Loop



Function 检查更新
    Set xPost = createObject("MSXML2.XMLHTTP")
    xPost.Open "GET", "https://github.com/Assumine/2048/wiki", False
    xPost.Send 
    Delay 10
    If xPost.readyState = 4 Then 
        TracePrint xPost.responsetext
        text11 = split(xPost.responsetext, "saa")
        For n=2 to UBound(text11)/2
            公告 = 公告 & text11(2 * n + 1) & chr(10)

        Next
                    Form2.Label1.Caption = 公告
                    If text11(1) = "1.0.1" Then 
                    Form2.Label2.Caption = "当前版本: " & text11(1)
                    	Else 
                    	 Form2.Label2.Caption = "当前版本有更新,点击更新"
                    End If

Else 
Form2.Label2.Caption ="网络错误"
    End If


    xPost.abort
    Set xPost = Nothing
End Function

Event Form2.Label2.Click
If Form2.Label2.Caption = "当前版本有更新,点击更新" Then 
Runapp "https://github.com/Assumine/2048/tree/%E6%BA%90%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%8F%8A%E6%89%93%E5%8C%85%E7%9A%84%E5%B0%8F%E7%B2%BE%E7%81%B5"
	
End If
End Event
Event Form2.Label7.Click
RunApp "https://github.com/Assumine/2048/tree/%E6%BA%90%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%8F%8A%E6%89%93%E5%8C%85%E7%9A%84%E5%B0%8F%E7%B2%BE%E7%81%B5"
End Event
